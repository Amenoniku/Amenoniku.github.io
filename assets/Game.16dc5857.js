var E=Object.defineProperty;var C=(i,e,t)=>e in i?E(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var u=(i,e,t)=>(C(i,typeof e!="symbol"?e+"":e,t),t);import{h as z,d as f,k as I,l as k,o as l,c as d,m as A,p as g,n as _,q as n,s as j,F as D,t as F,u as $,v as B,a as b}from"./vendor.cd1c6e51.js";import{u as S,_ as y}from"./index.918678e6.js";class m{}class p extends m{constructor(e,t,s){super();u(this,"size",{width:3,height:6});u(this,"icon");this.position=e,this.moving=t,this.shooter=s;const a={x:152,y:65},o={x:157,y:65};switch(s){case"Player":this.icon=o;break;case"Enemy":this.icon=a;break}}update(){switch(this.moving.direction){case"up":this.position.y-=this.moving.speed;break;case"down":this.position.y+=this.moving.speed;break}}}class v extends m{constructor(e){super();u(this,"screenWidth");u(this,"position");u(this,"size",{width:28,height:12});u(this,"icon",{x:138.5,y:75});u(this,"shoot",e=>{e.preventDefault(),this.data.gameObjects.push(new p({x:this.position.x+this.size.width/2,y:this.position.y-12},{speed:4,direction:"up"},"Player"))});u(this,"move",e=>{let t=e.offsetX-this.size.width/2;t<10&&(t=10),t>this.screenWidth&&(t=this.screenWidth),this.position.x=t});this.data=e,this.screenWidth=e.screenBox.x-40,this.position={x:e.screenBox.x/2-this.size.width/2,y:e.screenBox.y-30},this.data.screen.addEventListener("mousemove",this.move),this.data.screen.addEventListener("click",this.shoot)}update(){}}class c extends m{constructor(e,t,s,a){super();u(this,"speed",1+Math.random()*3);u(this,"icon");this.data=e,this.position=t,this.size=s,this.colNumber=a;const o=[{x:57,y:0},{x:98.5,y:0},{x:139,y:0},{x:9,y:30},{x:57,y:30},{x:98.5,y:30},{x:139,y:30}];this.icon=o[Math.floor(Math.random()*o.length)]}update(){this.move(),this.shoot()}move(){(this.position.x<3||this.position.x+this.size.width>this.data.screenBox.x-3)&&(this.speed=-this.speed);const e=this.position.x+this.speed;this.position.x=e}shoot(){const e=this.data.gameObjects.filter(t=>t instanceof c).length;if(Math.random()<.2/e){const t={x:this.position.x+this.size.width/2,y:this.position.y+this.size.height/2+this.size.height/2+1},s=new p(t,{speed:3,direction:"down"},"Enemy");this.data.gameObjects.push(s)}}isLower(){const e=this.data.gameObjects.filter(s=>s instanceof c&&s.colNumber===this.colNumber),t=Math.max.apply(Math,e.map(s=>s.position.y));return this.position.y===t}}class w{}class M extends w{constructor(e){super();u(this,"score",0);u(this,"size",{width:28,height:12});u(this,"position");u(this,"font",`bold ${this.size.height}px Arial`);u(this,"text",`Score: ${this.score}`);this.data=e,this.position={x:0,y:e.screenBox.y-this.size.height+9}}up(){this.text=`Score: ${++this.score}`}}var T="/assets/icons.4fec0796.png";const G=S();class N{constructor(e){u(this,"ctx");u(this,"screenBox");u(this,"gameObjects",[]);u(this,"gameStarted",!1);u(this,"gameStop",!0);u(this,"logicCycle",null);u(this,"icons",new Image);u(this,"notCollision",e=>this.isInterfaceObject(e)?!0:this.gameObjects.filter(t=>{if(e instanceof c&&t instanceof c||(e instanceof c||t instanceof c)&&(e instanceof p||t instanceof p)&&(e.shooter==="Enemy"||t.shooter==="Enemy"))return!1;const s=this.collision(e,t);return s&&e instanceof c&&this.gameObjects[0].up(),s&&e instanceof v&&this.screen.removeEventListener("click",e.shoot),s}).length===0);this.screen=e,this.ctx=this.screen.getContext("2d"),this.screenBox={x:this.screen.width,y:this.screen.height},this.icons.src=T,this.helloSreen()}helloSreen(){this.ctx.textAlign="center",this.ctx.fillStyle="rgba(255, 255, 255, 1)",this.ctx.font="bold 30px Arial",this.ctx.fillText("\u041A\u043B\u043E\u043D Space Invaders",this.screenBox.x/2,this.screenBox.y/2-35),this.ctx.font="18px Arial",this.ctx.fillText("\u0414\u043B\u044F \u0441\u0442\u0430\u0440\u0442\u0430 \u043D\u0430\u0436\u043C\u0438 \u041F\u041A\u041C",this.screenBox.x/2,this.screenBox.y/2+50)}start(){this.gameStarted=!0,this.gameStop=!1,this.addObjects(),this.renderTick(),this.logicTick()}pauseUnpause(){this.gameStop?(this.gameStop=!1,this.logicTick()):(this.gameStop=!0,clearInterval(this.logicCycle),this.logicCycle=null)}addObjects(){this.gameObjects.push(new M(this)),this.gameObjects.push(new v(this)),this.addEnemies()}addEnemies(){const e={width:29,height:25};let t=3,s=3;const a=8,o=5;let h=0;for(let r=0;r<a;r++){r===0?t=t:t+=e.height+e.height/3,h++;for(let x=0;x<o;x++)x===0?s=s:s+=e.width+e.width/3,this.gameObjects.push(new c(this,{x:t,y:s},e,h));s=3}}renderTick(){this.gameStop?setTimeout(()=>{this.renderTick()},100):(this.draw(),requestAnimationFrame(this.renderTick.bind(this)))}logicTick(){this.logicCycle=setInterval(()=>{this.update()},1e3/60)}update(){this.gameObjects.forEach((s,a)=>{this.isInterfaceObject(s)||(s.position.y<0||s.position.y>=this.screenBox.y?this.gameObjects.splice(a,1):s.update())}),this.gameObjects=this.gameObjects.filter(this.notCollision);const e=this.gameObjects.some(s=>s instanceof c),t=this.gameObjects.some(s=>s instanceof v);this.endGame(e,t)}isInterfaceObject(e){return e instanceof w}endGame(e,t){e||(alert('\u041F\u043E\u0437\u0434\u0440\u0430\u0432\u043B\u044F\u044E!!! \u0412\u044B \u043F\u043E\u0431\u0435\u0434\u0438\u043B\u0438 \u0418\u043D\u043E\u043F\u043B\u0430\u043D\u0435\u0442\u043D\u044B\u0445 \u0417\u0430\u0445\u0432\u0430\u0442\u0447\u0438\u043A\u043E\u0432! \u041D\u043E \u0440\u0430\u0434\u0430\u0440\u044B \u0437\u0430\u0441\u0435\u043A\u043B\u0438 \u0435\u0449\u0435 \u043E\u0434\u043D\u0443 \u0432\u043E\u043B\u043D\u0443! \u041D\u0430\u0436\u043C\u0438 "Ok" \u0447\u0442\u043E\u0431\u044B \u0440\u0430\u0437\u0433\u0440\u043E\u043C\u0438\u0442\u044C \u0432\u0440\u0430\u0433\u0430!'),this.gameObjects=this.gameObjects.filter(s=>!(s instanceof p)),this.addEnemies()),t||(this.gameStop=!0,this.gameObjects[0].score>0&&G.dispatch("addNewScore",{data:z().format("MMMM Do YYYY, h:mm:ss"),score:this.gameObjects[0].score}),this.gameObjects=[],this.addObjects(),this.gameStop=!1)}collision(e,t){return!(e===t||e.position.x+e.size.width<t.position.x||e.position.y+e.size.height<t.position.y||e.position.x>t.position.x+t.size.width||e.position.y>t.position.y+t.size.height)}clean(){this.ctx.clearRect(0,0,this.screenBox.x,this.screenBox.y)}draw(){this.clean(),this.gameObjects.forEach(e=>{e instanceof w&&(this.ctx.fillStyle="rgba(255, 255, 255, 1)",this.ctx.font=e.font,this.ctx.fillText(e.text,e.position.x,e.position.y)),e instanceof m&&this.ctx.drawImage(this.icons,e.icon.x,e.icon.y,e.size.width,e.size.height,e.position.x,e.position.y,e.size.width,e.size.height)})}}const P=i=>(g("data-v-1e99039c"),i=i(),_(),i),L=["onContextmenu"],Y=P(()=>n("p",null,"\u0412\u0430\u0448 \u0431\u0440\u0430\u0443\u0437\u0435\u0440 \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442 Canvas",-1)),W=[Y],q=f({setup(i){let e;const t=I(null),s=()=>{e.gameStarted?e.pauseUnpause():e.start()};return k(()=>{e=new N(t.value)}),(a,o)=>(l(),d("canvas",{class:"game-screen",ref:(h,r)=>{r.GameScreen=h,t.value=h},width:"400",height:"480",tabindex:"0",onContextmenu:A(s,["prevent"])},W,40,L))}});var U=y(q,[["__scopeId","data-v-1e99039c"]]);const O=i=>(g("data-v-0e943b02"),i=i(),_(),i),V={class:"flex"},R=O(()=>n("h3",null,"\u0422\u0430\u0431\u043B\u0438\u0446\u0430 \u0440\u0435\u043A\u043E\u0440\u0434\u043E\u0432",-1)),X=O(()=>n("div",{class:"scores"},[n("span",null,"\u0414\u0430\u0442\u0430"),n("span",null,"\u041E\u0447\u043A\u0438")],-1)),H={class:"scores"},J=f({setup(i){const e=S(),t=j(()=>e.state.scores.scores);return(s,a)=>(l(),d("div",V,[R,X,(l(!0),d(D,null,F($(t),o=>(l(),d("div",H,[n("span",null,B(o.data),1),n("span",null,B(o.score),1)]))),256))]))}});var K=y(J,[["__scopeId","data-v-0e943b02"]]);const Q=i=>(g("data-v-b7e33a0c"),i=i(),_(),i),Z={class:"flex"},ee=Q(()=>n("div",{class:"game-rule"},[n("h3",null,"\u0423\u043F\u0440\u0430\u0432\u043B\u0435\u043D\u0438\u0435"),n("span",null,"\u041F\u0435\u0440\u0435\u043C\u0435\u0449\u0435\u043D\u0438\u0435: \u041A\u0443\u0440\u0441\u043E\u0440"),n("span",null,"\u0412\u044B\u0441\u0442\u0440\u0435\u043B: \u041A\u043B\u0438\u043A \u041B\u041A\u041C"),n("span",null,"\u0421\u0442\u0430\u0440\u0442/\u041F\u0430\u0443\u0437\u0430: \u041A\u043B\u0438\u043A \u041F\u041A\u041C")],-1)),te=f({setup(i){return(e,t)=>(l(),d("div",Z,[ee,b(U),b(K)]))}});var ne=y(te,[["__scopeId","data-v-b7e33a0c"]]);export{ne as default};
